<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core" xmlns:http="http://www.mulesoft.org/schema/mule/http"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd">
	<sub-flow name="getRoutes-implementationSub_Flow" doc:id="53762032-4603-4e52-85db-6c96ed87fc65" >
		<choice doc:name="Choice" doc:id="7f7defa6-a648-47c7-a2e8-29381be2645f" >
			<when expression="#[vars.transportCompany  == 'FastGo']">
				<set-variable value="#[&quot;/api/&quot; ++ (vars.transportType default &quot;&quot;) ++ p('http.requester.FastGo.routesPath')]" doc:name="Set Variable" doc:id="4c247119-0431-4df2-bc1a-35daeb6cd0fc" variableName="resourcePath"/>
				<ee:cache doc:name="Cache" doc:id="0f8de2e7-c077-419e-93c0-b4b66c1c7706" cachingStrategy-ref="Caching_Strategy">
					<http:request method="GET" doc:name="Request" doc:id="26e12aae-68da-46e6-a154-1588f944ffe8" config-ref="HTTP_Request_configuration-FastGo" path="#[vars.resourcePath]">
					<http:headers><![CDATA[#[output application/java
---
{
	"transactionId" : vars.transactionId
}]]]></http:headers>
				</http:request>
					<ee:transform doc:name="Transform Message" doc:id="55448118-acc9-47e1-b47c-a286788c1590">
					<ee:message>
						<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
payload map(value,index)->(
	{
    "companyCode": vars.transportCompany,
    "originLocation": {
      "locationCode": value.departureLocationCode,
      "locationDesc": "Beauna Vista Singapore"
    },
    "destinationLocation": {
      "locationCode": value.arrivalLocationCode,
      "locationDesc": "Klang Malaysia"
    }
  }
)
]]></ee:set-payload>
					</ee:message>
				</ee:transform>
					<logger level="INFO" doc:name="Logger" doc:id="7f987edf-ce52-4f78-b69e-5b1a8bd3c31a" message="cache logger"/>
				</ee:cache>
			</when>
			<when expression="#[vars.transportCompany == 'TravelOnTip']">
			<set-variable value="#[&quot;/api/&quot; ++ (vars.transportType default &quot;&quot;) ++ p('http.requester.TravelOnTip.routesPath')]" doc:name="Set Variable" doc:id="b3141421-0a36-4d96-a852-58df08a1a23f" variableName="resourcePath"/>
				<ee:cache doc:name="Cache" doc:id="a838b700-9b45-48a7-881e-77129f667bc6" cachingStrategy-ref="Caching_Strategy">
					<http:request method="GET" doc:name="Request" doc:id="cca61084-242c-4647-ac88-6d502a6514c9" config-ref="HTTP_Request_configuration-TravelOnTip" path="#[vars.resourcePath]">
					<http:headers><![CDATA[#[output application/java
---
{
	"transactionId" : vars.transactionId
}]]]></http:headers>
				</http:request>
					<ee:transform doc:name="Transform Message" doc:id="5c7c6ae3-02a1-471b-9b6c-0dfbf0189c99">
					<ee:message>
						<ee:set-payload><![CDATA[%dw 2.0
output application/json
---
payload map(value,index)->(
	{
    "companyCode": vars.transportCompany,
    "originLocation": {
      "locationCode": value.departureLocationCode,
      "locationDesc": "Beauna Vista Singapore"
    },
    "destinationLocation": {
      "locationCode": value.arrivalLocationCode,
      "locationDesc": "Klang Malaysia"
    }
  }
)
]]></ee:set-payload>
					</ee:message>
				</ee:transform>
					<logger level="INFO" doc:name="Logger" doc:id="a00a8bee-26a8-4ce0-bf3e-3fa3e40ea4e7" message="cache logger"/>
				</ee:cache>
			</when>
		</choice>
	</sub-flow>
</mule>
